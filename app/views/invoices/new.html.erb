<div class="form-header">
  <p></p>
  <p class="form-title"> Checkout Page </p>
  <a href="/appointments/<%= params[:appointment_id] %>">x</a>
</div>
<div class="form-wrapper" id="checkout-page">
  <%= form_with model: @invoice, html: {class: 'height-100'} do |f| %>
    <div class="row height-100">
      <div class="col s9 pink-bg p-4 height-100">
        <div class="row">
          <div class="col s8 push-s2">
            <%= f.hidden_field :location_id %>
            <%= f.hidden_field :client_id %>
            <%= hidden_field_tag 'appointment_id', params[:appointment_id] %>
            <ul class="collapsible" style="border: none; box-shadow: none">
              <%= f.fields_for :lines, f.object.lines do |line| %>
                <%= render 'line_fields', f: line %>
              <% end %>
            </ul>
          </div>
        </div>
      </div>

      <div class="col s3  p-4 white-bg ">
        <%= render "shared/appointment_client", client: @appointment.client %>
        <div class="row">
          <div class="input-field col s12">
            <input placeholder="Placeholder" id="pay" type="number" class="validate">
            <label for="pay">Pay</label>
          </div>
        </div>
        <div id="payment-types-container">
<!--          content load as ajax will replace this -->
        </div>
        <div id="payment-types-container">
          <%= f.submit :complete_sale, class: 'payment_type main-bg mb-4 p-3' %>
          <div class="payment_type secondary-bg mb-4 p-3">
            Reset  Payments
          </div>
        </div>
        <div class="action">
          <!-- Dropdown Trigger -->
          <a class='dropdown-trigger btn' href='#' data-target='dropdown1'>Drop Me!</a>

          <!-- Dropdown Structure -->
          <ul id='dropdown1' class='dropdown-content'>
            <li><a href="#!">Invoice Details</a></li>
          </ul>
        </div>

      </div>
    </div>
  <% end %>
</div>

<script>
    function registerEvents() {
        $("#client-details").click(function () {
            document.location.href = '/clients/<%= @appointment.client.id %>';
        })
    }

    function loadPaymentTypes() {
        $.get('/payment_types.js')
    }

    $(document).on('turbolinks:load', function () {
        loadPaymentTypes();
        registerEvents();
        $('.collapsible').collapsible();
        $('.collapsible').collapsible('open', 0);


    })
</script>